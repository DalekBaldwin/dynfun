This is a copy of the code in the appendix of Pascal Costanza's paper ["Dynamically Scoped Functions as the Essence of AOP"] [1].

[1]:http://www.p-cos.net/documents/dynfun.pdf
